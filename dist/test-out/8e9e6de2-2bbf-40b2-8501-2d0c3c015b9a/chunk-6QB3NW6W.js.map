{
  "version": 3,
  "sources": ["src/app/core/services/wallet.service.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable, of } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nexport interface WalletTransaction {\n  id: string;\n  type: 'credit' | 'debit';\n  amount: number;\n  description: string;\n  date: string;\n}\n\nexport interface WalletState {\n  balance: number;\n  transactions: WalletTransaction[];\n}\n\n@Injectable({ providedIn: 'root' })\nexport class WalletService {\n  private walletSubject = new BehaviorSubject<WalletState>({ balance: 0, transactions: [] });\n  wallet$ = this.walletSubject.asObservable();\n\n  private readonly NON_WITHDRAWABLE_RULE = 'Withdrawals are not allowed. Wallet balance can be used for subscriptions or coupon generation.';\n\n  constructor() {\n    this.initializeMockWallet();\n  }\n\n  private initializeMockWallet(): void {\n    const state: WalletState = {\n      balance: 250,\n      transactions: [\n        { id: 'tx-1', type: 'credit', amount: 200, description: 'Initial top-up', date: new Date(Date.now() - 86400000).toISOString() },\n        { id: 'tx-2', type: 'debit', amount: 50, description: 'Course enrollment: Interview Simulation', date: new Date().toISOString() }\n      ]\n    };\n    this.walletSubject.next(state);\n  }\n\n  getWallet(): Observable<WalletState> {\n    return this.wallet$;\n  }\n\n  addFunds(amount: number, description = 'Wallet top-up'): Observable<WalletState> {\n    if (amount <= 0) {\n      throw new Error('Amount must be positive');\n    }\n\n    const current = this.walletSubject.value;\n    const updated: WalletState = {\n      balance: current.balance + amount,\n      transactions: [\n        { id: `tx-${Date.now()}`, type: 'credit', amount, description, date: new Date().toISOString() },\n        ...current.transactions\n      ]\n    };\n    this.walletSubject.next(updated);\n    return of(updated);\n  }\n\n  spend(amount: number, description: string): Observable<WalletState> {\n    const current = this.walletSubject.value;\n    if (amount <= 0) throw new Error('Amount must be positive');\n    if (current.balance < amount) throw new Error('Insufficient balance');\n\n    const updated: WalletState = {\n      balance: current.balance - amount,\n      transactions: [\n        { id: `tx-${Date.now()}`, type: 'debit', amount, description, date: new Date().toISOString() },\n        ...current.transactions\n      ]\n    };\n    this.walletSubject.next(updated);\n    return of(updated);\n  }\n\n  attemptWithdraw(amount: number): { success: false; message: string } {\n    return { success: false, message: this.NON_WITHDRAWABLE_RULE };\n  }\n\n  getRules(): string[] {\n    return [\n      'Money added to wallet is NON-WITHDRAWABLE.',\n      'Allowed uses: (1) automatic next-month subscription payments; (2) creating brand-sponsored coupons (admin-configured min/max).'\n    ];\n  }\n}"],
  "mappings": ";;;;;;;;;;;;;;IAkBa;;;;;AAlBb;AACA;AAiBO,IAAM,gBAAN,MAAMA,eAAa;MAChB,gBAAgB,IAAI,gBAA6B,EAAE,SAAS,GAAG,cAAc,CAAA,EAAE,CAAE;MACzF,UAAU,KAAK,cAAc,aAAY;MAExB,wBAAwB;MAEzC,cAAA;AACE,aAAK,qBAAoB;MAC3B;MAEQ,uBAAoB;AAC1B,cAAM,QAAqB;UACzB,SAAS;UACT,cAAc;YACZ,EAAE,IAAI,QAAQ,MAAM,UAAU,QAAQ,KAAK,aAAa,kBAAkB,MAAM,IAAI,KAAK,KAAK,IAAG,IAAK,KAAQ,EAAE,YAAW,EAAE;YAC7H,EAAE,IAAI,QAAQ,MAAM,SAAS,QAAQ,IAAI,aAAa,2CAA2C,OAAM,oBAAI,KAAI,GAAG,YAAW,EAAE;;;AAGnI,aAAK,cAAc,KAAK,KAAK;MAC/B;MAEA,YAAS;AACP,eAAO,KAAK;MACd;MAEA,SAAS,QAAgB,cAAc,iBAAe;AACpD,YAAI,UAAU,GAAG;AACf,gBAAM,IAAI,MAAM,yBAAyB;QAC3C;AAEA,cAAM,UAAU,KAAK,cAAc;AACnC,cAAM,UAAuB;UAC3B,SAAS,QAAQ,UAAU;UAC3B,cAAc;YACZ,EAAE,IAAI,MAAM,KAAK,IAAG,CAAE,IAAI,MAAM,UAAU,QAAQ,aAAa,OAAM,oBAAI,KAAI,GAAG,YAAW,EAAE;YAC7F,GAAG,QAAQ;;;AAGf,aAAK,cAAc,KAAK,OAAO;AAC/B,eAAO,GAAG,OAAO;MACnB;MAEA,MAAM,QAAgB,aAAmB;AACvC,cAAM,UAAU,KAAK,cAAc;AACnC,YAAI,UAAU;AAAG,gBAAM,IAAI,MAAM,yBAAyB;AAC1D,YAAI,QAAQ,UAAU;AAAQ,gBAAM,IAAI,MAAM,sBAAsB;AAEpE,cAAM,UAAuB;UAC3B,SAAS,QAAQ,UAAU;UAC3B,cAAc;YACZ,EAAE,IAAI,MAAM,KAAK,IAAG,CAAE,IAAI,MAAM,SAAS,QAAQ,aAAa,OAAM,oBAAI,KAAI,GAAG,YAAW,EAAE;YAC5F,GAAG,QAAQ;;;AAGf,aAAK,cAAc,KAAK,OAAO;AAC/B,eAAO,GAAG,OAAO;MACnB;MAEA,gBAAgB,QAAc;AAC5B,eAAO,EAAE,SAAS,OAAO,SAAS,KAAK,sBAAqB;MAC9D;MAEA,WAAQ;AACN,eAAO;UACL;UACA;;MAEJ;;;AAnEW,oBAAa,WAAA;MADzB,WAAW,EAAE,YAAY,OAAM,CAAE;OACrB,aAAa;;;",
  "names": ["WalletService"]
}
